{
  "version": 3,
  "sources": ["../../../../../lambda/courses/list/index.ts"],
  "sourcesContent": ["import { APIGatewayProxyEvent, APIGatewayProxyResult } from 'aws-lambda';\nimport { DynamoDBClient } from '@aws-sdk/client-dynamodb';\nimport { DynamoDBDocumentClient, ScanCommand } from '@aws-sdk/lib-dynamodb';\n\nconst dynamoClient = new DynamoDBClient({\n  region: process.env.AWS_REGION || 'us-east-1',\n  ...(process.env.STAGE === 'local' && {\n    endpoint: 'http://localhost:8000',\n    credentials: {\n      accessKeyId: 'local',\n      secretAccessKey: 'local',\n    },\n  }),\n});\n\nconst docClient = DynamoDBDocumentClient.from(dynamoClient);\n\nexport const handler = async (\n  event: APIGatewayProxyEvent\n): Promise<APIGatewayProxyResult> => {\n  try {\n    console.log('Listing courses...');\n    console.log('Table:', process.env.TABLE_NAME || 'ELearningPlatform-local');\n\n    // Scan with EntityType filter instead of SK\n    const result = await docClient.send(\n      new ScanCommand({\n        TableName: process.env.TABLE_NAME || 'ELearningPlatform-local',\n        FilterExpression: 'EntityType = :type OR (begins_with(PK, :prefix) AND SK = :sk)',\n        ExpressionAttributeValues: {\n          ':type': 'CourseMetadata',\n          ':prefix': 'COURSE#',\n          ':sk': 'METADATA',\n        },\n      })\n    );\n\n    console.log('Scan result count:', result.Count);\n    console.log('Items found:', JSON.stringify(result.Items, null, 2));\n\n    const courses = (result.Items || [])\n      .filter(item => item.courseId) // Only items with courseId\n      .map((item) => ({\n        courseId: item.courseId,\n        title: item.title,\n        description: item.description,\n        thumbnail: item.thumbnail || 'https://via.placeholder.com/400x200',\n        instructorName: item.instructorName,\n        price: item.price,\n        discountPrice: item.discountPrice,\n        currency: item.currency || 'USD',\n        category: item.category,\n        level: item.level,\n        totalStudents: item.totalStudents || 0,\n        averageRating: item.averageRating || 0,\n        totalDuration: item.totalDuration || 0,\n        totalLessons: item.totalLessons || 0,\n      }));\n\n    console.log('Formatted courses:', JSON.stringify(courses, null, 2));\n\n    return {\n      statusCode: 200,\n      headers: {\n        'Content-Type': 'application/json',\n        'Access-Control-Allow-Origin': '*',\n      },\n      body: JSON.stringify({\n        courses,\n        pagination: {\n          total: courses.length,\n          limit: 20,\n          hasMore: false,\n        },\n      }),\n    };\n  } catch (error) {\n    console.error('Error listing courses:', error);\n\n    return {\n      statusCode: 500,\n      headers: {\n        'Content-Type': 'application/json',\n        'Access-Control-Allow-Origin': '*',\n      },\n      body: JSON.stringify({\n        error: 'Internal server error',\n        message: error instanceof Error ? error.message : 'Unknown error',\n      }),\n    };\n  }\n};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,6BAA+B;AAC/B,0BAAoD;AAEpD,IAAM,eAAe,IAAI,sCAAe;AAAA,EACtC,QAAQ,QAAQ,IAAI,cAAc;AAAA,EAClC,GAAI,QAAQ,IAAI,UAAU,WAAW;AAAA,IACnC,UAAU;AAAA,IACV,aAAa;AAAA,MACX,aAAa;AAAA,MACb,iBAAiB;AAAA,IACnB;AAAA,EACF;AACF,CAAC;AAED,IAAM,YAAY,2CAAuB,KAAK,YAAY;AAEnD,IAAM,UAAU,OACrB,UACmC;AACnC,MAAI;AACF,YAAQ,IAAI,oBAAoB;AAChC,YAAQ,IAAI,UAAU,QAAQ,IAAI,cAAc,yBAAyB;AAGzE,UAAM,SAAS,MAAM,UAAU;AAAA,MAC7B,IAAI,gCAAY;AAAA,QACd,WAAW,QAAQ,IAAI,cAAc;AAAA,QACrC,kBAAkB;AAAA,QAClB,2BAA2B;AAAA,UACzB,SAAS;AAAA,UACT,WAAW;AAAA,UACX,OAAO;AAAA,QACT;AAAA,MACF,CAAC;AAAA,IACH;AAEA,YAAQ,IAAI,sBAAsB,OAAO,KAAK;AAC9C,YAAQ,IAAI,gBAAgB,KAAK,UAAU,OAAO,OAAO,MAAM,CAAC,CAAC;AAEjE,UAAM,WAAW,OAAO,SAAS,CAAC,GAC/B,OAAO,UAAQ,KAAK,QAAQ,EAC5B,IAAI,CAAC,UAAU;AAAA,MACd,UAAU,KAAK;AAAA,MACf,OAAO,KAAK;AAAA,MACZ,aAAa,KAAK;AAAA,MAClB,WAAW,KAAK,aAAa;AAAA,MAC7B,gBAAgB,KAAK;AAAA,MACrB,OAAO,KAAK;AAAA,MACZ,eAAe,KAAK;AAAA,MACpB,UAAU,KAAK,YAAY;AAAA,MAC3B,UAAU,KAAK;AAAA,MACf,OAAO,KAAK;AAAA,MACZ,eAAe,KAAK,iBAAiB;AAAA,MACrC,eAAe,KAAK,iBAAiB;AAAA,MACrC,eAAe,KAAK,iBAAiB;AAAA,MACrC,cAAc,KAAK,gBAAgB;AAAA,IACrC,EAAE;AAEJ,YAAQ,IAAI,sBAAsB,KAAK,UAAU,SAAS,MAAM,CAAC,CAAC;AAElE,WAAO;AAAA,MACL,YAAY;AAAA,MACZ,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,+BAA+B;AAAA,MACjC;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACnB;AAAA,QACA,YAAY;AAAA,UACV,OAAO,QAAQ;AAAA,UACf,OAAO;AAAA,UACP,SAAS;AAAA,QACX;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACF,SAAS,OAAO;AACd,YAAQ,MAAM,0BAA0B,KAAK;AAE7C,WAAO;AAAA,MACL,YAAY;AAAA,MACZ,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,+BAA+B;AAAA,MACjC;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACnB,OAAO;AAAA,QACP,SAAS,iBAAiB,QAAQ,MAAM,UAAU;AAAA,MACpD,CAAC;AAAA,IACH;AAAA,EACF;AACF;",
  "names": []
}
